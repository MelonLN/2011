    <!DOCTYPE html>
    <html lang="vi">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Ch√∫c M·ª´ng 20/11 - M·∫π Hu·ªá</title>
        <!-- Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Patrick+Hand&display=swap" rel="stylesheet">
        
        <style>
            :root {
                --primary-color: #ff7eb3;
                --text-color: #fff;
            }

            body, html {
                margin: 0;
                padding: 0;
                width: 100%;
                height: 100%;
                overflow: hidden;
                background-color: #050505; /* N·ªÅn t·ªëi nh·∫π */
                font-family: 'Patrick Hand', cursive;
            }

            canvas { display: block; }

            /* --- INTRO SCREEN --- */
            #intro-screen {
                position: absolute;
                top: 0; left: 0;
                width: 100%; height: 100%;
                background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                z-index: 100;
                cursor: pointer;
                transition: opacity 1s ease;
            }
            .bouquet {
                font-size: 100px;
                animation: float 3s ease-in-out infinite;
            }
            .intro-text {
                font-family: 'Dancing Script', cursive;
                font-size: 2.5rem;
                color: #d63384;
                margin-top: 20px;
                text-align: center;
                padding: 0 20px;
            }
            .tap-hint {
                margin-top: 50px;
                color: #888;
                animation: blink 1.5s infinite;
            }

            /* --- STORY SCREEN --- */
            #story-screen {
                position: absolute;
                top:0; left:0;
                width: 100%; height: 100%;
                z-index: 90;
                opacity: 0;
                pointer-events: none;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                transition: opacity 1s ease;
            }

            /* Background sliders */
            .bg-slider-layer {
                position: absolute;
                top:0; left:0;
                width: 100%; height: 100%;
                background-size: cover;
                background-position: center;
                opacity: 0;
                filter: blur(8px) brightness(0.3); /* T·ªëi h∆°n ƒë·ªÉ ch·ªØ r√µ */
                transition: opacity 2s ease-in-out;
                z-index: -1;
            }
            .bg-slider-layer.active {
                opacity: 1;
            }

            .message-container {
                position: relative;
                z-index: 95;
                width: 90%;
                max-width: 700px;
                text-align: center;
                color: white;
                min-height: 50vh; /* Gi·ªØ ch·ªó ƒë·ªÉ kh√¥ng b·ªã nh·∫£y layout */
                display: flex;
                flex-direction: column;
                justify-content: center;
            }
            
            /* Style cho t·ª´ng d√≤ng ch·ªØ khi g√µ */
            .text-line {
                font-size: 1.4rem;
                line-height: 1.6;
                margin-bottom: 15px;
                opacity: 1; /* ƒê·ªÉ script ƒëi·ªÅu khi·ªÉn hi·ªÉn th·ªã n·ªôi dung */
                min-height: 1.6rem; /* Gi·ªØ chi·ªÅu cao d√≤ng */
                text-shadow: 0 2px 5px rgba(0,0,0,0.8);
                display: none; /* ·∫®n m·∫∑c ƒë·ªãnh */
            }
            
            /* Con tr·ªè nh·∫•p nh√°y gi·∫£ l·∫≠p g√µ vƒÉn b·∫£n */
            .typing-cursor::after {
                content: '|';
                animation: blink 0.7s infinite;
                color: var(--primary-color);
            }

            .signature {
                font-family: 'Dancing Script', cursive;
                font-size: 2.2rem;
                color: var(--primary-color);
                margin-top: 40px;
                font-weight: bold;
                text-shadow: 0 0 10px rgba(255, 126, 179, 0.5);
                display: none;
            }

            /* --- 3D GALLERY --- */
            #gallery-screen {
                position: absolute;
                top:0; left:0;
                width:100%; height:100%;
                z-index: 1;
                background: #000;
                opacity: 0;
                transition: opacity 2s ease;
            }
            .hint-3d {
                position: absolute;
                bottom: 30px;
                width: 100%;
                text-align: center;
                color: rgba(255, 255, 255, 0.8);
                pointer-events: none;
                z-index: 10;
                font-size: 1.1rem;
                text-shadow: 0 0 10px #fff;
                animation: blink 3s infinite;
            }

            /* ANIMATIONS */
            @keyframes float {
                0%,100% { transform: translateY(0); }
                50% { transform: translateY(-20px); }
            }
            @keyframes blink {
                0%,100% { opacity:1; }
                50% { opacity:0; }
            }
        </style>
    </head>
    <body>

        <!-- 1. INTRO -->
        <div id="intro-screen">
            <div class="bouquet">üíê</div>
            <h1 class="intro-text">Ch√∫c m·ª´ng ng√†y nh√† gi√°o Vi·ªát Nam</h1>
            <div class="tap-hint">(Ch·∫°m v√†o m√†n h√¨nh ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh)</div>
        </div>

        <!-- 2. STORY (TEXT + SLIDER) -->
        <div id="story-screen">
            <div id="bg-slider1" class="bg-slider-layer active"></div>
            <div id="bg-slider2" class="bg-slider-layer"></div>
            
            <div class="message-container">
                <!-- C√°c d√≤ng ch·ªØ s·∫Ω ƒë∆∞·ª£c ƒëi·ªÅn n·ªôi dung t·ª´ script -->
                <p class="text-line" id="line1"></p>
                <p class="text-line" id="line2"></p>
                <p class="text-line" id="line3"></p>
                <p class="text-line" id="line4"></p>
                <p class="text-line" id="line5"></p>
                <p class="text-line" id="line6"></p>
                <p class="text-line" id="line7"></p>
                <div class="signature" id="sig">
                </div>
            </div>
        </div>

        <!-- 3. 3D GALLERY -->
        <div id="gallery-screen">
            <div class="hint-3d">K√©o th·∫£ ƒë·ªÉ xoay - Cu·ªôn ƒë·ªÉ ph√≥ng to v≈© tr·ª•</div>
            <!-- Canvas s·∫Ω ƒë∆∞·ª£c ch√®n v√†o ƒë√¢y -->
        </div>

        <!-- AUDIO -->
        <audio id="bg-music" src="./ad.mp3" loop></audio>

        <!-- IMPORT MAP -->
        <script type="importmap">
            {
                "imports": {
                    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
                    "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
                }
            }
        </script>

        <!-- MAIN SCRIPT -->
        <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    import { EffectComposer } from 'three/addons/postprocessing/EffectComposer.js';
    import { RenderPass } from 'three/addons/postprocessing/RenderPass.js';
    import { UnrealBloomPass } from 'three/addons/postprocessing/UnrealBloomPass.js';
    import { OutputPass } from 'three/addons/postprocessing/OutputPass.js';

    // --- D·ªÆ LI·ªÜU ---
    const storyContent = [
        "D√π m·ªói ng√†y t·ª•i con ƒë·ªÅu tr√¢n tr·ªçng nh·ªØng g√¨ m·∫π Hu·ªá d√†nh cho t·ª•i con...",
        "Nh∆∞ng 20‚Äì11 l√† d·ªãp ƒë·∫∑c bi·ªát ƒë·ªÉ g·ª≠i l·ªùi c·∫£m ∆°n tr·ªçn v·∫πn...",
        "M·ªôt k·ª∑ ni·ªám kh√¥ng th·ªÉ thi·∫øu trong thanh xu√¢n c·∫•p 3 c·ªßa t·ª•i con.",
        "C·∫£m ∆°n m·∫π v√¨ s·ª± t·∫≠n t√¢m, ki√™n nh·∫´n, y√™u th∆∞∆°ng v√† lu√¥n ƒë·ªìng h√†nh.",
        "Nh·ªØng g√¨ m·∫π l√†m, d√π nh·ªè, lu√¥n ƒë∆∞·ª£c t·ª•i con ghi nh·ªõ.",
        "K√≠nh ch√∫c m·∫π Hu·ªá m·∫°nh kh·ªèe, b√¨nh an, h·∫°nh ph√∫c...",
        "V√† gia ƒë√¨nh lu√¥n ·∫•m √°p, tr√†n ƒë·∫ßy ti·∫øng c∆∞·ªùi."
    ];

    const teacherImages = [
        "./z7135639962596_a723e332b2bc614873d381fca27f3d9b.jpg",
        "./z7135639913716_35575a1344b4d2cedf0061ddfc14285c.avif",
        "./z7135639937577_d5a8d141b94cae7f03f79b6ec8d655b5.jpg",
        "./z7135777360971_8eeb164d9c0c9e2873f77bf855416717.jpg",
        "./z7206508634961_e3c012f03d7c24c338fb8d5a407c3135.jpg",
        "./z7221388307337_9ada818c98fddfa6bf91263657146ef6.jpg",
        "./z7197853952697_0a5f6e22dc3557542806836f3c1ce824.jpg",
        "./z7197757311413_b622cc3d2c104cc5f5f6291a8ea15d2c.jpg",
        "./z7183083771401_905b8fa8d19725aea0c722bbb5aa5bf0.jpg"
    ];

    // DOM Elements
    const introScreen = document.getElementById('intro-screen');
    const storyScreen = document.getElementById('story-screen');
    const galleryScreen = document.getElementById('gallery-screen');
    const bg1 = document.getElementById('bg-slider1');
    const bg2 = document.getElementById('bg-slider2');
    const music = document.getElementById('bg-music');

    let currentImgIdx = 0;
    let toggle = true;
    let bgInterval;

    // --- PH·∫¶N 1: INTRO & STORY ---
    introScreen.addEventListener('click', () => {
        introScreen.style.opacity = '0';
        music.volume = 0.5;
        music.play().catch(e => console.log("Autoplay prevented"));

        setTimeout(() => {
            introScreen.style.display = 'none';
            startStory();
        }, 1000);
    });

    function changeBackground() {
        const nextImg = teacherImages[currentImgIdx];
        currentImgIdx = (currentImgIdx + 1) % teacherImages.length;
        if(toggle) {
            bg2.style.backgroundImage = `url('${nextImg}')`;
            bg2.classList.add('active');
            bg1.classList.remove('active');
        } else {
            bg1.style.backgroundImage = `url('${nextImg}')`;
            bg1.classList.add('active');
            bg2.classList.remove('active');
        }
        toggle = !toggle;
    }

    async function typeWriter(elementId, text, speed = 50) {
        const element = document.getElementById(elementId);
        element.style.display = 'block';
        element.classList.add('typing-cursor');
        
        for (let i = 0; i < text.length; i++) {
            element.textContent += text.charAt(i);
            const randomSpeed = speed + (Math.random() * 20 - 10);
            await new Promise(r => setTimeout(r, randomSpeed));
        }
        
        element.classList.remove('typing-cursor');
    }

    async function startStory() {
        storyScreen.style.opacity = '1';
        storyScreen.style.pointerEvents = 'auto';

        changeBackground();
        bgInterval = setInterval(changeBackground, 4000);

        await new Promise(r => setTimeout(r, 500));
        for(let i=0; i<storyContent.length; i++){
            await typeWriter(`line${i+1}`, storyContent[i]);
            await new Promise(r => setTimeout(r, 500));
        }

        await new Promise(r => setTimeout(r, 1000));
        await typeWriter('sig', "THPT Tr·∫ßn Ph√∫ ‚Äì 20/11/2025\nL·ªõp A1 ‚Äì K43");

        setTimeout(finishStory, 4000);
    }

    function finishStory() {
        clearInterval(bgInterval);
        storyScreen.style.opacity = '0';
        storyScreen.style.pointerEvents = 'none';
        
        setTimeout(() => {
            storyScreen.style.display = 'none';
            galleryScreen.style.opacity = '1';
            init3DWorld(); 
        }, 2000);
    }

    // --- PH·∫¶N 2: 3D WORLD ---
    function init3DWorld() {
        const scene = new THREE.Scene();

        // --- HEART PLANET AT CENTER ---
const heartShape = new THREE.Shape();
heartShape.moveTo(0, 0.5);
heartShape.bezierCurveTo(0.5, 1.3, 1.4, 1.1, 1.4, 0.4);
heartShape.bezierCurveTo(1.4, -0.2, 0.8, -0.6, 0, -1.2);
heartShape.bezierCurveTo(-0.8, -0.6, -1.4, -0.2, -1.4, 0.4);
heartShape.bezierCurveTo(-1.4, 1.1, -0.5, 1.3, 0, 0.5);

// Extrude ƒë·ªÉ n√≥ c√≥ ƒë·ªô d√†y nh∆∞ h√†nh tinh
const extrudeSettings = {
    depth: 0.6,
    bevelEnabled: true,
    bevelSegments: 20,
    steps: 2,
    bevelSize: 0.2,
    bevelThickness: 0.2
};

const heartGeometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettings);

const heartMaterial = new THREE.MeshStandardMaterial({
    color: 0xff5fa2,
    metalness: 0.4,
    roughness: 0.3,
    emissive: 0xff3d8e,
    emissiveIntensity: 0.3
});

const heartPlanet = new THREE.Mesh(heartGeometry, heartMaterial);
heartPlanet.position.set(0, 0, 0);
// heartPlanet.rotation.x = Math.PI;      // Cho n√≥ ƒë·ª©ng th·∫≥ng ƒë·∫πp h∆°n
heartPlanet.scale.set(2, 2, 2);         // TƒÉng k√≠ch th∆∞·ªõc v·ª´a m·∫Øt

scene.add(heartPlanet);


        scene.background = new THREE.Color(0x020207);
        scene.fog = new THREE.FogExp2(0x020207, 0.015);

        const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
        camera.position.set(0, 2, 25);

        const renderer = new THREE.WebGLRenderer({antialias:true});
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.toneMapping = THREE.ACESFilmicToneMapping;
        renderer.toneMappingExposure = 1.6;
        galleryScreen.appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.05;
        controls.autoRotate = true;
        controls.autoRotateSpeed = 0.5;
        controls.maxDistance = 60;
        controls.minDistance = 5;

        // --- LIGHTS ---
        const ambientLight = new THREE.AmbientLight(0xffffff, 0.45);
        scene.add(ambientLight);

        const pointLights = [];
        for(let i=0; i<5; i++){
            const color = (i%2===0) ? 0xffffff : 0xffffee;
            const light = new THREE.PointLight(color, 2, 30);
            light.userData = {
                angle: (i/5)*Math.PI*2,
                radius: 8 + Math.random()*5,
                speed: 0.02 + Math.random()*0.02,
                yOffset: (Math.random()-0.5)*8
            };
            scene.add(light);
            pointLights.push(light);
        }

        // --- STARFIELD ---
        const starGeo = new THREE.BufferGeometry();
        const starCount = 6000;
        const starPos = new Float32Array(starCount*3);
        for(let i=0; i<starCount*3; i++) starPos[i] = (Math.random()-0.5)*200;
        starGeo.setAttribute('position', new THREE.BufferAttribute(starPos,3));
        const stars = new THREE.Points(starGeo,new THREE.PointsMaterial({color:0xffffff,size:0.2,transparent:true,opacity:0.8}));
        scene.add(stars);

        // --- KH·ªêI 3D BAY B·ªíNG B·ªÄNH (thay nebula) ---
        const objectGroup = new THREE.Group();
        scene.add(objectGroup);
        const geometries = [
            new THREE.SphereGeometry(1,32,16),
            new THREE.BoxGeometry(1.5,1.5,1.5),
            new THREE.TorusKnotGeometry(0.8,0.3,100,16),
            new THREE.IcosahedronGeometry(1.2)
        ];
        for(let i=0;i<50;i++){
            const geom = geometries[Math.floor(Math.random()*geometries.length)];
            const mat = new THREE.MeshStandardMaterial({
                color: new THREE.Color().setHSL(Math.random(),0.8,0.5),
                metalness: Math.random()*0.8+0.1,
                roughness: Math.random()*0.5+0.1,
                emissive: new THREE.Color().setHSL(Math.random(),0.9,0.3),
                emissiveIntensity: Math.random()>0.7?Math.random()*2+0.5:0
            });
            const mesh = new THREE.Mesh(geom,mat);
            mesh.position.set(
                (Math.random()-0.5)*80,
                (Math.random()-0.5)*15,
                (Math.random()-0.5)*80
            );
            mesh.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI);
            const scale = Math.random()*0.8+0.4;
            mesh.scale.set(scale,scale,scale);
            mesh.userData = {
                rotationSpeed: new THREE.Vector3((Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02,(Math.random()-0.5)*0.02),
                bobSpeed: Math.random()*0.05+0.01,
                bobAmplitude: Math.random()*0.5+0.1,
                initialY: mesh.position.y
            };
            objectGroup.add(mesh);
        }

        // --- LOAD ·∫¢NH C√î GI√ÅO ---
        const textureLoader = new THREE.TextureLoader();
        const imageGroup = new THREE.Group();
        scene.add(imageGroup);

        const displayImages = [...teacherImages,...teacherImages];
        displayImages.forEach((url,i)=>{
            textureLoader.load(url,(tex)=>{
                const aspectRatio = tex.image.width/tex.image.height;
                const height = 3.5;
                const width = height*aspectRatio;
                const geometry = new THREE.PlaneGeometry(width,height);
                const material = new THREE.MeshStandardMaterial({
                    map: tex,
                    side: THREE.DoubleSide,
                    roughness:0.2,
                    metalness:0.1,
                    emissive:0x000000,
                    emissiveIntensity:0
                });
                const mesh = new THREE.Mesh(geometry,material);
                const angle = (i/displayImages.length)*Math.PI*2;
                const radius = 18;
                mesh.position.x = Math.cos(angle)*radius;
                mesh.position.z = Math.sin(angle)*radius;
                mesh.position.y = (Math.random()-0.5)*5;
                mesh.lookAt(0,0,0);
                mesh.userData = {originalY: mesh.position.y,speed:0.3+Math.random()*0.5,offset:Math.random()*Math.PI};
                imageGroup.add(mesh);
            });
        });

        // --- BLOOM ---
        const renderScene = new RenderPass(scene,camera);
        const bloomPass = new UnrealBloomPass(new THREE.Vector2(window.innerWidth,window.innerHeight),1.0,0.5,0.2);
        const outputPass = new OutputPass();
        const composer = new EffectComposer(renderer);
        composer.addPass(renderScene);
        composer.addPass(bloomPass);
        composer.addPass(outputPass);

        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);
            const time = clock.getElapsedTime();
            heartPlanet.rotation.y += 0.01;

            controls.update();

            // stars xoay
            stars.rotation.y = time*0.02;

            // imageGroup b·ªìng b·ªÅnh
            imageGroup.children.forEach(mesh=>{
                if(mesh.userData.originalY!==undefined){
                    mesh.position.y = mesh.userData.originalY+Math.sin(time*mesh.userData.speed+mesh.userData.offset)*0.5;
                }
            });

            // pointLights
            pointLights.forEach(light=>{
                const ud = light.userData;
                ud.angle += ud.speed;
                light.position.x = Math.cos(ud.angle)*ud.radius;
                light.position.z = Math.sin(ud.angle)*ud.radius;
                light.position.y = Math.sin(time+ud.yOffset)*5;
            });

            // kh·ªëi 3D
            objectGroup.children.forEach(obj=>{
                obj.rotation.x += obj.userData.rotationSpeed.x;
                obj.rotation.y += obj.userData.rotationSpeed.y;
                obj.rotation.z += obj.userData.rotationSpeed.z;
                obj.position.y = obj.userData.initialY+Math.sin(time*obj.userData.bobSpeed*50)*obj.userData.bobAmplitude;
            });

            composer.render();
        }

        animate();

        window.addEventListener('resize',()=>{
            camera.aspect = window.innerWidth/window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth,window.innerHeight);
            composer.setSize(window.innerWidth,window.innerHeight);
        });
    }

        </script>
    </body>
    </html>
